<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:attr="lang=${#locale}" lang="es">
<head>
    <title th:text="${title}">UML generator</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23333'/%3E%3Ctext x='50' y='50' font-family='Arial' font-size='40' fill='white' text-anchor='middle' dominant-baseline='middle'%3EUML%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" th:href="@{/css/base.css}" href="/css/base.css" />
    <link rel="stylesheet" th:href="@{/css/skins/neobrutalist.css}" href="/css/skins/neobrutalist.css" />
    <link rel="stylesheet" th:href="@{/css/skins/glass.css}" href="/css/skins/glass.css" />
    <link rel="stylesheet" th:href="@{/css/skins/win95.css}" href="/css/skins/win95.css" />
</head>
<body>
    <!-- Selector de Skins -->
    <div class="skin-selector">
        <!-- Select nativo (fallback). Se ocultará al mejorar con JS -->
        <select id="skinSelector" onchange="changeSkin()">
            <option value="default" th:text="#{skin.elegant}">Elegant</option>
            <option value="neobrutalist" th:text="#{skin.neobrutalist}">Neobrutalist</option>
            <option value="glass" th:text="#{skin.glass}">Glass</option>
            <option value="win95" th:text="#{skin.win95}">Windows 95</option>
        </select>

        <!-- Selector personalizado con opciones estilizadas -->
        <div class="skin-picker" id="skinPicker">
            <button type="button" class="skin-picker__button" id="skinPickerButton" aria-haspopup="listbox" aria-expanded="false">
                <span class="skin-chip chip-elegant" aria-hidden="true"></span>
                <span class="skin-picker__label" th:text="#{skin.elegant}">Elegant</span>
            </button>
            <ul class="skin-picker__list" id="skinPickerList" role="listbox" hidden>
                <li role="option" id="skin-opt-default" data-value="default" class="skin-option opt-elegant">
                    <span class="skin-chip chip-elegant" aria-hidden="true"></span>
                    <span class="opt-label" th:text="#{skin.elegant}">Elegant</span>
                </li>
                <li role="option" id="skin-opt-neobrutalist" data-value="neobrutalist" class="skin-option opt-neo">
                    <span class="skin-chip chip-neo" aria-hidden="true"></span>
                    <span class="opt-label" th:text="#{skin.neobrutalist}">Neobrutalist</span>
                </li>
                <li role="option" id="skin-opt-glass" data-value="glass" class="skin-option opt-glass">
                    <span class="skin-chip chip-glass" aria-hidden="true"></span>
                    <span class="opt-label" th:text="#{skin.glass}">Glass</span>
                </li>
                <li role="option" id="skin-opt-win95" data-value="win95" class="skin-option opt-win95">
                    <span class="skin-chip chip-win95" aria-hidden="true"></span>
                    <span class="opt-label" th:text="#{skin.win95}">Windows 95</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- Selector de Idioma -->
    <div class="lang-switcher" role="group" aria-label="Language selector">
        <button type="button" class="lang-btn" onclick="setLang('es')" th:title="#{lang.es}" th:attr="aria-label=#{lang.es}">
            <img class="flag" src="/img/flags/es.png" th:src="@{/img/flags/es.png}" alt="" aria-hidden="true" />
        </button>
        <button type="button" class="lang-btn" onclick="setLang('en')" th:title="#{lang.en}" th:attr="aria-label=#{lang.en}">
            <img class="flag" src="/img/flags/gb.png" th:src="@{/img/flags/gb.png}" alt="" aria-hidden="true" />
        </button>
    </div>

    <div class="container">
        <!-- Win95 Titlebar (visible only in Win95 skin) -->
        <div class="win95-window-titlebar" aria-hidden="true">
            <div class="title-left">
                <span class="sys-icon" aria-hidden="true"></span>
                <span class="title-text" th:text="${title}">UML Generator</span>
            </div>
            <div class="caption">
                <span class="btn min" title="Minimize"></span>
                <span class="btn max" title="Maximize"></span>
                <span class="btn close" title="Close"></span>
            </div>
        </div>

        <!-- Win95 Menubar (decorative) -->
        <nav class="win95-menubar" aria-hidden="true">
            <button type="button" class="menu-item">File</button>
            <button type="button" class="menu-item">Edit</button>
            <button type="button" class="menu-item">Help</button>
        </nav>
        <header class="site-header">
            <div class="win95-caption" aria-hidden="true">
                <span class="btn min" title="Minimize"></span>
                <span class="btn max" title="Maximize"></span>
                <span class="btn close" title="Close"></span>
            </div>
            <h1 class="site-title" th:text="${title}">UML Generator</h1>
            <p class="site-description" th:text="${description}">Genera diagramas UML profesionales a partir de tu código fuente Java. Simplemente sube tu proyecto en formato .zip y obtén una visualización clara y detallada de tu arquitectura.</p>
        </header>
        
        <form class="upload-form" method="post" enctype="multipart/form-data" action="/upload">
            <div class="file-input-wrapper">
                <input id="fileInput" type="file" name="file" th:attr="accept=#{ui.file.accept}" accept=".zip" />
                <button type="button" class="file-browse" onclick="document.getElementById('fileInput').click()" th:text="#{ui.file.browse}">Seleccionar archivo</button>
                <span id="fileNameLabel" class="file-name" th:text="#{ui.file.placeholder}">Selecciona un archivo .zip</span>
            </div>
            <button type="submit" th:text="#{ui.upload.button}">Generar Diagrama UML</button>
        </form>
        
        <p class="message" th:if="${message != null and !message.empty}" th:text="${message}"></p>
        
        <div th:if="${diagramUrl}" class="diagram-container">
            <div class="diagram-actions">
                <button class="action-button" onclick="window.open(document.querySelector('.diagram-preview img').src, '_blank')" th:text="#{ui.actions.viewNewWindow}">
                    <svg viewBox="0 0 24 24"><path d="M19 19H5V5h7V3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/></svg>
                </button>
                <a th:href="${diagramUrl}" download="diagrama.svg" class="action-button" th:text="#{ui.actions.downloadSvg}">
                    <svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                </a>
            </div>
            <div class="diagram-preview">
                <img th:src="@{${diagramUrl}}" th:alt="#{ui.diagram.alt}" alt="Diagrama UML" />
            </div>
        </div>

        <!-- Win95 Status bar (decorative) -->
        <div class="win95-statusbar" aria-hidden="true">
            <div class="pane">Ready</div>
            <div class="pane right">UML-Generator</div>
        </div>
    </div>

    <script th:src="@{/js/app.js}" src="/js/app.js"></script>
</body>
</html>
